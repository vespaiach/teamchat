import{a as N,b as U,d as H,e as R,f as W,g as w,h as T,i as f,j as A,k as I}from"./common-GJLHGDKW.js";import{j as B,l as G,n as L}from"./common-6IRAT4QG.js";import{a as S}from"./common-HPS6C7QP.js";import{a as o,b as k,c as _,d as g,k as u,l as z,m as y}from"./common-ATYGQR7Y.js";var M=o(k(),1),K=o(_(),1);var F=o(k(),1);var O=o(u(),1);function P({className:t}){return(0,O.jsx)("span",{className:g("block flex items-center justify-center",t),children:"#"})}var x=o(k(),1);var q=o(u(),1),D=G("logged-in-user");if(!D)throw new Error("User data not found. Ensure the user data is embedded in the HTML.");var $=(0,x.createContext)({groupConversations:[],groupConversationsLoading:!0,directConversations:[],directConversationsLoading:!0,loggedInUser:B(D),selectedChannelId:null,selectChannel:()=>{}});function V({children:t}){let[s,i]=(0,x.useState)(null),[l]=(0,x.useState)(B(D)),{groupConversationsLoading:c,groupConversations:r,setGroupChannels:d}=R(),{directConversationsLoading:b,directConversations:p,setDirectChannels:X}=U(),Y=(0,x.useMemo)(()=>p.map(m=>({...m,partner:m.participants.find(h=>h.id!==l.id)})),[p,l.id]);return W(m=>{d(h=>h.find(v=>v.id===m.id)?h.map(v=>v.id===m.id?{...v,...m}:v):[...h,m])}),H(m=>{X(h=>h.find(v=>v.id===m.id)?h.map(v=>v.id===m.id?{...v,...m}:v):[...h,m])}),(0,q.jsx)($.Provider,{value:{groupConversations:r,groupConversationsLoading:c,directConversations:Y,directConversationsLoading:b,loggedInUser:l,selectedChannelId:s,selectChannel:i},children:t})}function C(){let t=(0,x.useContext)($);if(!t)throw new Error("useConversationsStore must be used within a ConversationsContext");return t}var a=o(u(),1);function j(){let{groupConversationsLoading:t,groupConversations:s,selectChannel:i,selectedChannelId:l}=C(),[c,r]=(0,F.useState)(!0);return(0,a.jsxs)("div",{className:"p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white flex items-center gap-1 cursor-pointer",role:"button",tabIndex:0,onClick:()=>{r(!c)},children:[(0,a.jsx)(w,{className:g("h-3 w-3 transition-transform",!c&&"rotate-180")}),"Channels"]}),(0,a.jsx)(L,{variant:"ghost",size:"sm",className:"p-1 h-6 w-6","aria-label":"Add channel",icon:(0,a.jsx)(f,{})})]}),t&&(0,a.jsx)("div",{className:"flex items-center justify-center h-12 text-gray-500 dark:text-gray-400",children:"Loading channels..."}),!t&&s.length===0&&(0,a.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-sm text-center",children:"No channels available. Create or join a channel to start chatting."}),c&&(0,a.jsx)("div",{className:"space-y-1",children:s.map(d=>(0,a.jsx)(ee,{channel:d,onClick:()=>i(d.id),selected:d.id===l},d.id))})]})}function ee({channel:t,selected:s=!1,onClick:i}){return(0,a.jsx)("div",{onClick:i,role:"menuitem",tabIndex:0,className:g("flex items-center justify-between px-2 py-1.5 rounded cursor-pointer transition-colors duration-200",s?"bg-blue-100 dark:bg-blue-900/30 text-blue-900 dark:text-blue-100":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:t.isPublic?(0,a.jsx)(P,{}):(0,a.jsx)(A,{})}),(0,a.jsx)("span",{className:"text-sm font-medium truncate",children:t.name}),t.hasUnreadMessages&&(0,a.jsx)(I,{})]})})}var J=o(k(),1);var n=o(u(),1);function E(){let{directConversations:t,directConversationsLoading:s,selectedChannelId:i,selectChannel:l}=C(),[c,r]=(0,J.useState)(!0);return(0,n.jsxs)("div",{className:"p-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,n.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white flex items-center gap-1 cursor-pointer",role:"button",tabIndex:0,onClick:()=>{r(!c)},children:[(0,n.jsx)(w,{className:g("h-3 w-3 transition-transform",!c&&"rotate-180")}),"Direct Messages"]}),(0,n.jsx)(L,{variant:"ghost",size:"sm",className:"p-1 h-6 w-6","aria-label":"Add channel",icon:(0,n.jsx)(f,{})})]}),s&&(0,n.jsx)("div",{className:"flex items-center justify-center h-12 text-gray-500 dark:text-gray-400",children:"Loading channels..."}),c&&(0,n.jsx)("div",{className:"space-y-1",children:t.map(d=>(0,n.jsx)(te,{channel:d,onClick:()=>l(d.id),selected:d.id===i},d.id))})]})}function te({channel:t,selected:s=!1,onClick:i}){return(0,n.jsxs)("div",{onClick:i,role:"menuitem",tabIndex:0,className:g("flex items-center gap-2 px-2 py-1.5 rounded cursor-pointer  transition-colors duration-200",s?"bg-blue-100 dark:bg-blue-900/30":"hover:bg-gray-100 dark:hover:bg-gray-700"),children:[(0,n.jsx)("div",{className:"relative",children:(0,n.jsx)(N,{user:t.partner})}),(0,n.jsx)("div",{className:"flex-1 min-w-0",children:(0,n.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,n.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:t.partner.name}),t.hasUnreadMessages&&(0,n.jsx)(I,{})]})})]})}var e=o(u(),1);function Q(){let{selectedChannelId:t,selectChannel:s,groupConversations:i,directConversations:l,loggedInUser:c}=C();return(0,M.useEffect)(()=>{if(t===null){let r=parseInt(new URLSearchParams(window.location.search).get("channel")??"0",10),d=i.find(p=>p.id===r);if(d){s(d.id);return}let b=l.find(p=>p.id===r);if(b){s(b.id);return}i.length>0&&s(i[0].id),l.length>0&&s(l[0].id)}},[t,i,l,s]),(0,e.jsxs)("div",{className:"page-container flex",children:[(0,e.jsxs)("div",{className:"w-80 bg-gray-50 dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col transition-colors duration-200",children:[(0,e.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,e.jsx)(z,{size:28}),(0,e.jsx)("div",{className:"flex items-center space-x-2",children:(0,e.jsx)(y,{variant:"primary",size:"sm",className:"px-3",leftIcon:(0,e.jsx)(f,{className:"h-4 w-4"}),children:"New"})})]}),(0,e.jsx)(S,{name:"search",placeholder:"Search TeamChat",size:"sm",icon:(0,e.jsx)(T,{className:"h-4 w-4 text-gray-400"})})]}),(0,e.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,e.jsx)(j,{}),(0,e.jsx)(E,{})]}),(0,e.jsx)("div",{className:"p-3 border-t border-gray-200 dark:border-gray-700",children:(0,e.jsxs)("div",{className:"flex items-center space-x-3 px-2 py-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer transition-colors duration-200",children:[(0,e.jsx)("div",{className:"relative",children:(0,e.jsx)(N,{user:c})}),(0,e.jsxs)("div",{className:"flex-1",children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:c.name}),(0,e.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Available"})]})]})})]}),(0,e.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,e.jsxs)("div",{className:"h-16 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 px-6 flex items-center justify-between transition-colors duration-200",children:[(0,e.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,e.jsx)("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"# general"}),(0,e.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400",children:[(0,e.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),(0,e.jsx)("span",{children:"12 members"})]})]}),(0,e.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,e.jsx)(y,{variant:"ghost",size:"sm",onClick:()=>window.location.href="/home",leftIcon:(0,e.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),children:"Home"}),(0,e.jsx)(y,{variant:"ghost",size:"sm",leftIcon:(0,e.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),children:"Details"})]})]}),(0,e.jsx)("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[].map(r=>(0,e.jsxs)("div",{className:`flex items-start space-x-3 ${r.isOwnMessage?"flex-row-reverse space-x-reverse":""}`,children:[(0,e.jsx)("div",{className:"flex-shrink-0",children:(0,e.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium text-white",style:{backgroundColor:"var(--primary)"},children:r.avatar})}),(0,e.jsxs)("div",{className:`flex-1 ${r.isOwnMessage?"text-right":""}`,children:[(0,e.jsxs)("div",{className:`flex items-center space-x-2 mb-1 ${r.isOwnMessage?"justify-end":""}`,children:[(0,e.jsx)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:r.user}),(0,e.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:r.timestamp})]}),(0,e.jsx)("div",{className:`inline-block max-w-lg px-4 py-2 rounded-lg ${r.isOwnMessage?"text-white":"bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white"}`,style:r.isOwnMessage?{backgroundColor:"var(--primary)"}:{},children:(0,e.jsx)("p",{className:"text-sm",children:r.content})})]})]},r.id))}),(0,e.jsxs)("div",{className:"p-4 bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700 transition-colors duration-200",children:[(0,e.jsxs)("div",{className:"flex items-end space-x-3",children:[(0,e.jsx)("div",{className:"flex-1",children:(0,e.jsx)(S,{name:"message",placeholder:"Type a message...",className:"pr-20",icon:(0,e.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),iconPosition:"right"})}),(0,e.jsx)(y,{variant:"primary",size:"md",leftIcon:(0,e.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),children:"Send"})]}),(0,e.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,e.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,e.jsx)("button",{className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-200",children:(0,e.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),(0,e.jsx)("button",{className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-200",children:(0,e.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 4V2a1 1 0 011-1h8a1 1 0 011 1v2h4a1 1 0 110 2h-1v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6H3a1 1 0 110-2h4z"})})}),(0,e.jsx)("button",{className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-200",children:(0,e.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})})})]}),(0,e.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Press"," ",(0,e.jsx)("kbd",{className:"px-1 py-0.5 text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded dark:bg-gray-800 dark:text-gray-100 dark:border-gray-700",children:"Enter"})," ","to send"]})]})]})]})]})}(0,K.createRoot)(document.getElementById("root")).render((0,e.jsx)(M.StrictMode,{children:(0,e.jsx)(V,{children:(0,e.jsx)(Q,{})})}));export{Q as default};
